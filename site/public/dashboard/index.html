<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/global.css">
    <link rel="shortcut icon" href="../assets/imgs/icone-aba.jpg" type="image/x-icon">
    <script type="text/javascript" src="https://www.chartjs.org/dist/2.8.0/Chart.min.js"></script>
    <title>Guardian Angel</title>
</head>

<body onload="funcionario()">
    <!-- Barra de navegação lateral -->
    <aside class="l-side-bar">
        <section class="wrapper">
            <figure class="logo">
                <img src="../assets/imgs/logo_v3.png" alt="Logotipo da Guardian Angel">
            </figure>

            <label>Olá, <span id="hello-message1">cargo</span></label>

            <ul class="link-pages">
                <li>
                    <a href="#perfil">Perfil</a>
                </li>
                <li>
                    <a href="#func">Funcionários</a>
                </li>
                <li>
                    <a href="#relat">Relatórios</a>
                </li>
            </ul>

            <button type="button" id="exit">Sair</button>
        </section>
    </aside>

    <aside class="r-side-bar">
        <section>
            <article>
                <button type="button" class="menu-collapse">
                    Funcionários
                    <img class="btn-arrow" src="../assets/svg/arrow.svg" alt="Seta do menu">
                </button>
                
                <div id="listaFunc">
                </div>
            </article>
            
            <article>
                <button type="button" class="new-func">
                    <img src="../assets/svg/cross.svg" alt="Cruz do botão novo funcionário">
                    <a href="novoFuncionario.html">Novo funcionário</a>
                </button>
            </article>

            <article>
                <button type="button" class="menu-collapse">
                    Meu computador
                    <img class="btn-arrow" src="../assets/svg/arrow.svg" alt="Seta do menu">
                </button>
                <ul class="list-collapse2">
                    <!-- li 'alguma coisa' li -->
                </ul>
            </article>
        </section>
    </aside>

    <!-- Modal para cadastrar novo usuário -->
    <!-- <section class="modal">
        <div class="modal-input">
            <label for="">Campo 1</label>
            <input type="text" id="">
        </div>

        <div class="modal-input">
            <label for="">Campo 1</label>
            <input type="text" id="">
        </div>

        <div class="modal-input">
            <label for="">Campo 1</label>
            <input type="text" id="">
        </div>
    </section> -->

    <main>
        <section class="top-message">
            <label>Bem vindo ao seu portal</label>
            <label class="status-check">
                Status: <span id="status">status</span>
                <img src="../assets/svg/circle.svg" alt="status image"></label>
        </section>

        <section>
            <article  class="dashboard" id="1">
                <div style="position: relative; height:100%; width:40%">
                    <canvas id="chart-1" width="100%" height="100%"></canvas>
                </div>

                <div class="process">
                    <section id="process-table" class="table-container">
                        <article>
                            <table>
                                <tbody id="table1">
                                    <tr>
                                        <th>Processo</th>
                                        <th>Uso (%)</th>
                                    </tr>
                                </tbody>
                            </table>
                        </article>
                    </section>
                </div>
            </article>
        </section>
    </main>
</body>

<script src="js/global.js"></script>
<script src="js/dashboard.js"></script>

</html>
<script>
    var vFuncionario = ""
    const loadF = document.getElementById("listaFunc")
function funcionario(){
    fetch("../usuarios/verfuncionario", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        }
    }).then(function (resposta) {

        console.log("resposta: ", resposta);
        if (resposta.ok) {
            resposta.json().then(json => {
                console.log(json);
                console.log(JSON.stringify(json));
                vFuncionario = json
                loadF.addEventListener('load', listaUsuario())
              });
        } else {
            throw ("Houve um erro ao tentar realizar consulta!");
        }
    }).catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        alert("Houve um erro ao tentar realizar consulta!")
    });
    return false;
}
function listaUsuario(){
    for (i = 0; i < vFuncionario.length; i++) {
                var texto = document.createTextNode(vFuncionario[i].nome);
                var cUl = document.createElement("ul");
                cUl.classList.add("list-collapse");
                var cLi = document.createElement("li");
                cLi.appendChild(texto);
                cUl.appendChild(cLi);
                document.getElementById("listaFunc").appendChild(cUl);
              }
}
</script>